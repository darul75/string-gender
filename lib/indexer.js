/*! 
* @license string-gender - v0.0.5
* (c) 2014 Julien VALERY https://github.com/darul75/string-gender
* License: MIT 
*/
function Indexer(){this.tfidf=new TfIdf,this.index={},this.docs={}}var TfIdf=require("./tfidf"),constants=require("./constants");module.exports=Indexer,Indexer.prototype.addDocument=function(a,b){this.docs[a]=b;for(var c in b)this.tfidf.addDocument(b[c],a+":"+c)};var splitRegex=/[\-_ ]+/g;Indexer.prototype.query=function(a){var b=this.tfidf,c={};b.tfidfs(a,function(a,b,d){d=d.split(":");{var e=d[0];d[1]}c[e]||(c[e]=0),c[e]+=b});var d=[];for(var e in c)if(c[e]>0){var f=this.docs[e];_digestCountry(f),d.push({key:e,measure:c[e],doc:f})}return d.sort(function(a,b){return b.measure-a.measure})};var _digestCountry=function(a){for(var b=[],c=0;c<a.countries.length;c++)if(_isNumeric(a.countries[c])){var d=constants.COUNTRIES[c];b.push({name:d,ISO:_getISOCode(d),frequency:a.countries[c]})}a.countries=b},_getISOCode=function(a){var b=constants.ISO_3166_MAPPING;for(var c in b)if(b.hasOwnProperty(c)&&b[c]===a)return c;return""},_isNumeric=function(a){return!isNaN(parseInt(a,10))};